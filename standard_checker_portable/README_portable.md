# Standard Version Checker ポータブル版 (Windows)

ISO/IEC 17025スコープ証明書から標準規格を抽出し、ETSIポータルと連携するWebアプリケーションのポータブル版です。

## 📋 システム要件

### 必須要件
- **OS**: Windows 10/11 (64-bit)
- **メモリ**: 4GB以上推奨
- **ディスク容量**: 500MB以上の空き容量
- **インターネット接続**: 初回セットアップ時のみ必要

### 推奨要件
- **ブラウザ**: Chrome 90+, Firefox 88+, Edge 90+
- **解像度**: 1920x1080以上推奨

## 🚀 インストール手順

### Step 1: ファイルの展開

1. ダウンロードしたZIPファイルを任意のフォルダに展開
2. 展開後のフォルダ構造を確認：
   ```
   standard_checker_portable/
   ├── python_portable/          # 空フォルダ（後でPythonを配置）
   ├── packages/                 # 依存関係パッケージ
   ├── standard_checker/         # アプリケーション本体
   ├── start.bat                # 起動スクリプト
   └── README_portable.md       # このファイル
   ```

### Step 2: Python Embeddable Packageのダウンロード

1. **Python公式サイトにアクセス**
   - ブラウザで https://www.python.org/downloads/windows/ を開く

2. **適切なバージョンを選択**
   - "Python 3.11.x - 2023-xx-xx" を探す
   - **重要**: "Windows embeddable package (64-bit)" を選択
   - **注意**: "Windows installer (64-bit)" は使用しない

3. **ダウンロード実行**
   - ファイル名例: `python-3.11.8-embed-amd64.zip`
   - サイズ: 約8-10MB

### Step 3: Pythonの配置

1. **ダウンロードしたZIPファイルを解凍**
   - 右クリック → "すべて展開" または "解凍"
   - 解凍先を `standard_checker_portable/python_portable/` に指定

2. **配置確認**
   ```
   standard_checker_portable/python_portable/
   ├── python.exe              # メインのPython実行ファイル
   ├── pythonw.exe             # GUI用Python実行ファイル
   ├── python311.dll           # Python DLL
   ├── python311._pth          # Pythonパス設定
   └── ...                     # その他のファイル
   ```

3. **重要**: `python.exe` が存在することを確認

### Step 4: 初回起動とセットアップ

1. **起動スクリプトの実行**
   - `start.bat` をダブルクリック
   - コマンドプロンプトが開き、セットアップが開始

2. **セットアッププロセス**
   ```
   🚀 Standard Version Checker ポータブル版を起動中...
   📦 依存関係をインストール中...
   📥 pipをダウンロード中...
   ✅ 依存関係のインストールが完了しました
   🌐 アプリケーションを起動中...
   ```

3. **完了確認**
   - "INFO: Application startup complete." が表示されれば成功
   - ブラウザで http://localhost:8000 にアクセス可能

## 🎯 使用方法

### アプリケーションの起動

1. **通常起動**
   - `start.bat` をダブルクリック
   - コマンドプロンプトが開き、アプリケーションが起動

2. **ブラウザアクセス**
   - 自動でブラウザが開かない場合は手動で http://localhost:8000 にアクセス

### アプリケーションの停止

1. **正常停止**
   - コマンドプロンプトで `Ctrl+C` を押す
   - "Shutting down" メッセージが表示される

2. **強制停止**
   - コマンドプロンプトウィンドウを閉じる

### 機能の使用

1. **PDFファイルのアップロード**
   - ホーム画面で「ファイルを選択」をクリック
   - ISO/IEC 17025スコープ証明書のPDFを選択

2. **標準規格の抽出**
   - アップロード後、自動的に標準規格が抽出される
   - 結果は画面に表示される

3. **ETSIポータル連携**
   - 「ETSI照会」タブで標準規格の詳細情報を確認

4. **結果のエクスポート**
   - 抽出結果をExcelファイルとしてダウンロード可能

## 📁 データ管理

### 自動作成されるディレクトリ

```
standard_checker_portable/standard_checker/data/
├── input/                     # アップロードされたPDFファイル
├── output/                    # 処理結果とエクスポートファイル
└── logs/                      # アプリケーションログ
```

### データのバックアップ

- 重要なデータは `data/output/` フォルダに保存されます
- 定期的にバックアップを取ることを推奨

## 🔧 トラブルシューティング

### よくある問題と解決方法

#### 1. Pythonが見つからないエラー
```
❌ ポータブルPythonが見つかりません。
```

**原因**: Python Embeddable Packageが正しく配置されていない

**解決方法**:
1. `python_portable/` フォルダに `python.exe` が存在するか確認
2. 存在しない場合、Step 2-3を再実行
3. ファイル名が正しいか確認（`python-3.11.x-embed-amd64.zip`）

#### 2. 依存関係のインストールエラー
```
ERROR: Could not install packages due to an EnvironmentError
```

**原因**: インターネット接続または権限の問題

**解決方法**:
1. インターネット接続を確認
2. ファイアウォールがPowerShellの実行をブロックしていないか確認
3. `packages/installed.flag` ファイルを削除して再インストール
4. 管理者権限でコマンドプロンプトを実行

#### 3. ポート8000が使用中エラー
```
ERROR: [Errno 10048] Only one usage of each socket address
```

**原因**: 他のアプリケーションがポート8000を使用中

**解決方法**:
1. 他のアプリケーションを停止
2. または、`standard_checker/app/main.py` でポート番号を変更

#### 4. アプリケーションが起動しない
```
ModuleNotFoundError: No module named 'fastapi'
```

**原因**: 依存関係が正しくインストールされていない

**解決方法**:
1. `packages/installed.flag` ファイルを削除
2. `start.bat` を再実行
3. セットアッププロセスを完了

#### 5. ブラウザでアクセスできない
```
This site can't be reached
```

**原因**: アプリケーションが正常に起動していない

**解決方法**:
1. コマンドプロンプトのエラーメッセージを確認
2. アプリケーションが完全に起動するまで待機（約30秒）
3. ファイアウォールの設定を確認

### ログファイルの確認

問題が発生した場合は、以下のログファイルを確認：

```
standard_checker_portable/standard_checker/data/logs/
├── app.log                    # アプリケーションログ
└── error.log                  # エラーログ
```

## 🔒 セキュリティ

### セキュリティ機能
- **ローカルホスト限定**: 外部からのアクセスは不可
- **ファイル保存**: アップロードされたファイルはローカルに保存
- **外部通信**: ETSIポータルへの照会のみ

### 推奨事項
- 重要なPDFファイルは処理後に削除
- 定期的にログファイルを確認
- 不要なファイルは手動で削除

## 📞 サポート

### 問題報告時の情報
問題が発生した場合は、以下の情報を準備してください：

1. **エラーメッセージ**: コマンドプロンプトに表示されたエラー
2. **ログファイル**: `data/logs/` フォルダの内容
3. **システム情報**: Windows バージョン、メモリ容量
4. **実行手順**: 問題が発生した手順

### よくある質問

**Q: 管理者権限は必要ですか？**
A: 不要です。ポータブル版は管理者権限なしで動作します。

**Q: インターネット接続は常に必要ですか？**
A: 初回セットアップ時のみ必要です。その後はオフラインでも動作します。

**Q: 他のPCにコピーできますか？**
A: 可能です。フォルダ全体をコピーして使用できます。

**Q: アンチウイルスソフトで警告が出ます**
A: 誤検知の可能性があります。必要に応じて除外設定を追加してください。

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🔄 アップデート

### 新しいバージョンの適用
1. 新しいZIPファイルをダウンロード
2. 既存のフォルダをバックアップ
3. 新しいファイルで上書き
4. `start.bat` を実行してセットアップ

### データの移行
- `data/output/` フォルダの内容を新しいバージョンにコピー
- 設定ファイルがある場合は同様に移行

---

**注意**: このポータブル版は、管理者権限なしでWindowsマシンで動作するように設計されています。問題が発生した場合は、上記のトラブルシューティングを参照してください。 